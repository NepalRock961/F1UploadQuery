SELECT distinct
CIF_ID AS ORGKEY
,CIF_ID AS CIFID 
,'CUSTOMER'     AS ENTITYTYPE
,'' AS CUST_TYPE_CODE 
,case when upper(gender) liKe 'M%' THEN 'MR.'
WHEN UPPER(GENDER) LIKE 'F%' THEN 'MISS.'
ELSE 'MS.' END SALUTATION_CODE
,upper(REPLACE(CUST_FIRST_NAME,'|',''))  AS CUST_FIRST_NAME  
,upper(REPLACE(CUST_MIDDLE_NAME,'|',''))     AS CUST_MIDDLE_NAME  
,upper(REPLACE(CUST_LAST_NAME ,'|',''))   AS  CUST_LAST_NAME  
,upper(REPLACE(SUBSTR(CUST_FIRST_NAME,1,50),'|','')) AS PREFERREDNAME 
,upper(REPLACE(SUBSTR(CUST_FIRST_NAME,1,8),'|',''))  AS SHORT_NAME    
,'2-FEB-2000'   AS CUST_DOB -- DEFAULT
,  case when upper(gender) liKe 'M%' THEN 'M'
WHEN UPPER(GENDER) LIKE 'F%' THEN 'F'
ELSE 'O' END  AS GENDER 
,'' AS OCCUPATION_CODE 
,'NEPALI' AS NATIONALITY
,''     as NATIVELANGTITLE  
,''     AS NATIVELANGNAME 
,'Y'    AS DOCUMENT_RECIEVED   
,'N'    as STAFFFLAG
,''     AS STAFFEMPLOYEEID
,'UBSADMIN' AS MANAGER 
,'N' AS CUSTOMERNREFLAG 
,'' AS DATEOFBECOMINGNRE -- not needed as CUSTOMERNREFLAG is 'N'
,'N'  AS CUSTOMERMINOR 
,'' AS MINORGAURDIANID   
,'' AS MINOR_GUARD_CODE 
,'' AS MINOR_GUARD_NAME 
,'NOTA' AS REGION
,SOL_ID AS PRIMARY_SERVICE_CENTRE 
,--CASE WHEN TO_dATE(nvl(case when NVL(CUST_OPN_DATE,(SELECT MIN (ACCT_OPN_DATE) FROM GAM WHERE GAM.CUST_ID = C.CUST_ID GROUP BY GAM.CUST_ID))>(select db_stat_date from gct) then TO_CHAR((select db_stat_date from gct),'DD-MON-RRRR') else
--to_char(NVL(CUST_OPN_DATE,(SELECT MIN (ACCT_OPN_DATE) FROM GAM WHERE GAM.CUST_ID = C.CUST_ID GROUP BY GAM.CUST_ID)),'DD-MON-RRRR') end, to_char((select db_stat_date from gct),'DD-MON-YYYY')),'DD-MM-YYYY')<= TO_DATE(case   WHEN NVL(CBS.DATE_OF_BIRTH,C.DATE_OF_BIRTH) IS NULL THEN '28-FEB-1994'  
  --      when NVL(CBS.DATE_OF_BIRTH,C.DATE_OF_BIRTH) > (select db_stat_date from gct) then '28-FEB-1994' 
    --    else TO_CHAR(NVL(CBS.DATE_OF_BIRTH,C.DATE_OF_BIRTH),'DD-MON-YYYY') end,'DD-MM-YYYY') THEN case   WHEN NVL(CBS.DATE_OF_BIRTH,C.DATE_OF_BIRTH) IS NULL THEN '28-FEB-1994'  
      --  when NVL(CBS.DATE_OF_BIRTH,C.DATE_OF_BIRTH) > (select db_stat_date from gct) then '28-FEB-1994' 
        --else TO_CHAR(NVL(CBS.DATE_OF_BIRTH,C.DATE_OF_BIRTH),'DD-MON-YYYY') end    ELSE  nvl(case when NVL(CUST_OPN_DATE,(SELECT MIN (ACCT_OPN_DATE) FROM GAM WHERE GAM.CUST_ID = C.CUST_ID GROUP BY GAM.CUST_ID))>(select db_stat_date from gct) then TO_CHAR((select db_stat_date from gct),'DD-MON-RRRR') else
--to_char(NVL(CUST_OPN_DATE,(SELECT MIN (ACCT_OPN_DATE) FROM GAM WHERE GAM.CUST_ID = C.CUST_ID GROUP BY GAM.CUST_ID)),'DD-MON-RRRR') end, to_char((select db_stat_date from gct),'DD-MON-YYYY')) END    
 case when CUSTOMER_ONBORD_DATE>(select db_stat_date from tbaadm.gct) then (select to_char(db_stat_date,'dd-mon-yyyy') from tbaadm.gct)
 else to_char(CUSTOMER_ONBORD_DATE,'dd-mon-yyyy') end AS RELATIONSHIPOPENINGDATE     
,'' AS STATUS_CODE 
,'' AS CUSTSTATUSCHGDATE
,'' AS HOUSEHOLDID
,'' AS HOUSEHOLDNAME                                         
,'NPR' AS CRNCY_CODE_RETAIL
,'' AS RATING_CODE --should be MED, LOW  --5char
,'' AS RATINGDATE
,'' AS CUST_PREF_TILL_DATE   
,'NA' AS TDS_TBL_CODE   
,''     AS INTRODUCERID  
,''     AS INTRODUCERSALUTATION  
,''     AS INTRODUCERNAME  
,'' AS INTRODUCERSTATUSCODE
,'' AS OFFLINE_CUM_DEBIT_LIMIT
,'' AS CUST_TOT_TOD_ALWD_TIMES
,'' AS CUST_COMMU_CODE
,'' AS CARD_HOLDER
,'' AS CUST_HLTH 
,'' AS CUST_HLTH_CODE 
,'N'    AS TFPARTYFLAG
,to_char(sol_id) AS PRIMARY_SOL_ID  
,'' AS CONSTITUTION_REF_CODE
,'' AS CUST_OTHR_BANK_CODE
,'' AS CUST_FIRST_ACCT_DATE
,'' AS CHRG_LEVEL_CODE
,'' AS CHRG_DR_FORACID
,'' AS CHRG_DR_SOL_ID
,'N'    AS CUST_CHRG_HISTORY_FLG
,''    AS COMBINED_STMT_REQD
,''     AS LOANS_STMT_TYPE
,''     AS TD_STMT_TYPE
,''     AS COMB_STMT_CHRG_CODE
,'' AS DESPATCH_MODE    --ASKED
,'' AS CS_LAST_PRINTED_DATE
,'' AS CS_NEXT_DUE_DATE
,'N' AS ALLOW_SWEEPS--ASKED   
,'' AS PS_FREQ_TYPE
,'' AS PS_FREQ_WEEK_NUM
,'' AS PS_FREQ_WEEK_DAY
,'' AS PS_FREQ_START_DD
,'' AS PS_FREQ_HLDY_STAT
,'' AS ENTITY_TYPE  
,'' AS LINKEDRETAILCIF
,'' AS HSHLDUFLAG  
,'' AS SMALL_STR1
,'' AS SMALL_STR2
,'' AS SMALL_STR3
,'' AS SMALL_STR4
,'' AS SMALL_STR5
,'' AS SMALL_STR6
,'' AS SMALL_STR7
,'' AS SMALL_STR8
,'' AS SMALL_STR9
,'' AS SMALL_STR10
,'' AS MED_STR1
,'' AS MED_STR2
,'' AS MED_STR3
,'' AS MED_STR4
,'' AS MED_STR5
,'' AS MED_STR6
,'' AS MED_STR7
,'' AS MED_STR8
,'' AS MED_STR9
,'' AS MED_STR10
,'' AS LARGE_STR1
,'' AS LARGE_STR2
,'' AS LARGE_STR3
,'' AS LARGE_STR4
,'' AS LARGE_STR5
,'' AS DATE1
,'' AS DATE2
,'' AS DATE3
,'' AS DATE4
,'' AS DATE5
,'' AS DATE6
,'' AS DATE7
,'' AS DATE8
,'' AS DATE9
,'' AS DATE10
,'' AS NUMBER1
,'' AS NUMBER2
,'' AS NUMBER3
,'' AS NUMBER4
,'' AS NUMBER6
,'' AS NUMBER5
,'' AS NUMBER7
,'' AS NUMBER8
,'' AS NUMBER9
,'' AS NUMBER10
,'' AS DECIMAL1
,'' AS DECIMAL2
,'' AS DECIMAL3
,'' AS DECIMAL4
,'' AS DECIMAL5
,'' AS DECIMAL6
,'' AS DECIMAL7
,'' AS DECIMAL8
,'' AS DECIMAL9
,'' AS DECIMAL10
,replace(CIF_ID,'R','') AS CORE_CUST_ID 
,'' AS PERSONTYPE
,'World (English)' AS CUST_LANGUAGE 
,'' AS CUST_STAFF_STATUS
,'' AS PHONE
,'' AS EXTENSION
,'' AS FAX
,'' AS FAX_HOME
,substr('NAVA',1,25) AS PHONE_HOME
,'' AS PHONE_HOME2
,replace(MOBILE_NUMBER,'|','')             AS PHONE_CELL
,'' AS EMAIL_HOME
,'' AS EMAIL_PALM
,replace(email_id,'|','') AS EMAIL
,'' AS CITY   
,'' AS PREFERREDCHANNELID
,'' AS CUSTOMERRELATIONSHIPNO
,'' AS RELATIONSHIPVALUE
,'' AS CATEGORY
,'' AS NUMBEROFPRODUCTS
,'' AS RELATIONSHIPMGRID
,'' AS RELATIONSHIPCREATEDBYID   --Id of user who created the relationship, in demographic
,'' AS URL  
,''     AS STATUS
,'' AS INDUSTRY
,'' AS PARENTORG
,'' AS COMPETITOR
,'' AS SICCODE
,'' AS CIN
,'' AS DESIGNATION
,'' AS ASSISTANT
,'' AS INTERNALSCORE
,'' AS CREDITBUREAUSCOREVALIDITY
,'' AS CREDITBUREAUSCORE
,'' AS CREDITBUREAUREQUESTDATE
,'' AS CREDITBUREAUDESCRIPTION
,'' AS MAIDENNAMEOFMOTHER
,'' AS ANNUALREVENUE
,'' AS REVENUEUNITS
,'' AS TICKERSYMBOL
,'N'    AS AUTOAPPROVAL --self
,'N'    AS FREEZEPRODUCTSALE --self
,'' AS RELATIONSHIPFIELD1
,'' AS RELATIONSHIPFIELD2
,'' AS RELATIONSHIPFIELD3
,'' AS DELINQUENCYFLG  
,'N' AS CUSTOMERNREFLG   
,'' AS COMBINEDSTATEMENTFLG
,'' AS CUSTOMERTRADE
,'' AS PLACEOFBIRTH 
,'' AS COUNTRYOFBIRTH 
,'' AS PROOFOFAGEFLAG
,'' AS PROOFOFAGEDOCUMENT
,'' AS NAMESUFFIX
,'' AS MAIDENNAME
,'' AS CUSTOMERPROFITABILITY
,'' AS CURRENTCREXPOSURE
,'' AS TOTALCREXPOSURE
,'' AS POTENTIALCRLINE
,'' AS AVAILABLECRLIMIT
,'' AS CREDITSCOREREQUESTEDFLAG
,'' AS CREDITHISTORYREQUESTEDFLAG
,'' as GROUPID
,'' AS FLG1
,'' AS FLG2
,'' AS FLG3
,'' AS ALERT1
,'' AS ALERT2
,'' AS ALERT3
,'' AS RELATIONSHIPOFFER1
,'' AS RELATIONSHIPOFFER2
,'' AS DTDATE1
,'' AS DTDATE2
,'' AS DTDATE3
,'' AS DTDATE4
,'' AS DTDATE5
,'' AS DTDATE6
,'' AS DTDATE7
,'' AS DTDATE8
,'' AS DTDATE9
,'' AS AMOUNT1 --asked 
,'' AS AMOUNT2
,'' AS AMOUNT3
,'' AS AMOUNT4
,'' AS AMOUNT5
,'' AS STRFIELD1  
,'' AS STRFIELD2
,'' AS STRFIELD3
,'' AS STRFIELD4
,'' AS STRFIELD5
,'' AS STRFIELD6
,'' AS STRFIELD7
,'' AS STRFIELD8
,'' AS STRFIELD9
,'' AS STRFIELD10
,'' AS STRFIELD11
,'' AS STRFIELD12
,'N' AS STRFIELD13  --whether the customer is a member of SBG. Valid Values Y/N.
,'' AS STRFIELD14  -- dependent on STRFIELD13
,'' AS STRFIELD15
,'' AS USERFLAG1
,'' AS USERFLAG2
,'' AS USERFLAG3
,'' AS USERFLAG4
,'' AS MLUSERFIELD1
,'' AS MLUSERFIELD2
,'' AS MLUSERFIELD3
,'' AS MLUSERFIELD4
,'' AS MLUSERFIELD5
,'' AS MLUSERFIELD6
,'' AS MLUSERFIELD7
,'' AS MLUSERFIELD8
,'' AS MLUSERFIELD9
,'' AS MLUSERFIELD10
,'' AS MLUSERFIELD11
,'' AS NOTES
,'' AS PRIORITYCODE
,'' AS CREATED_FROM
,'' AS CONSTITUTION_CODE
,'N' AS STRFIELD16  
,''AS STRFIELD17
,'' AS STRFIELD18
,'' AS STRFIELD19
,'' AS STRFIELD20
,'' AS STRFIELD21
,'' AS STRFIELD22
,'' AS AMOUNT6
,'' AS AMOUNT7
,'' AS AMOUNT8
,'' AS AMOUNT9
,'' AS AMOUNT10
,'' AS AMOUNT11
,'' AS AMOUNT12
,'' AS INTFIELD1
,'' AS INTFIELD2
,'' AS INTFIELD3
,'' AS INTFIELD4
,'' AS INTFIELD5
,'' AS NICK_NAME
,'' AS MOTHER_NAME
,'' AS FATHER_HUSBAND_NAME  
,'' AS PREVIOUS_NAME
,'' AS LEAD_SOURCE
,'' AS RELATIONSHIP_TYPE
,'' AS RM_GROUP_ID
,'' AS RELATIONSHIP_LEVEL
,'' AS DSA_ID
,'' AS PHOTOGRAPH_ID
,'' AS SECURE_ID 
,'' AS DELIQUENCYPERIOD
,'' AS ADDNAME1
,'' AS ADDNAME2
,'' AS ADDNAME3
,'' AS ADDNAME4
,'' AS ADDNAME5
,'' AS OLDENTITYCREATEDON ---?
,'' AS OLDENTITYTYPE
,'' AS OLDENTITYID
,'' AS DOCUMENT_RECEIVED
,'' AS SUSPEND_NOTES
,'' AS SUSPEND_REASON
,'' AS BLACKLIST_NOTES
,'' AS BLACKLIST_REASON
,'' AS NEGATED_NOTES
,'' AS NEGATED_REASON
,'CLSA' AS  SEGMENTATION_CLASS  ---???mand
,REPLACE(REPLACE(NVL(CUST_FIRST_NAME,CUST_LAST_NAME),'"',''),'|','') AS        NAME
,'' AS MANAGEROPINION  --FOR GIVING REMARKS BY MANAGER. /NULL 
,'' AS INTROD_STATUS
,'INFENG' AS NATIVELANGCODE  
,'' AS MINORATTAINMAJORDATE   --Date on which Minor attains Major statuS
,'' AS NREBECOMINGORDDATE
,'' AS STARTDATE
,'' AS ADD1_FIRST_NAME
,'' AS ADD1_MIDDLE_NAME
,'' AS ADD1_LAST_NAME
,'' AS ADD2_FIRST_NAME
,'' AS ADD2_MIDDLE_NAME
,'' AS ADD2_LAST_NAME
,'' AS ADD3_FIRST_NAME
,'' AS ADD3_MIDDLE_NAME
,'' AS ADD3_LAST_NAME
,'' AS ADD4_FIRST_NAME
,'' AS ADD4_MIDDLE_NAME
,'' AS ADD4_LAST_NAME
,'' AS ADD5_FIRST_NAME
,'' AS ADD5_MIDDLE_NAME
,'' AS ADD5_LAST_NAME
,'' AS DUAL_FIRST_NAME
,'' AS DUAL_MIDDLE_NAME
,'' AS DUAL_LAST_NAME
,'' AS CUST_COMMUNITY
,'' AS CORE_INTROD_CUST_ID
,'' AS INTROD_SALUTATION_CODE
,'' AS TDS_CUST_ID
,'' AS NAT_ID_CARD_NUM  --CitizenshipNo?
,''  AS PSPRT_ISSUE_DATE
,'' AS PSPRT_DET       
,'' AS PSPRT_EXP_DATE   
,'NPR' AS CRNCY_CODE
,'1' AS PREF_CODE
,'' AS INTROD_STATUS_CODE
,'' AS NATIVELANGTITLE_CODE
,'' AS GROUPID_CODE
,'' AS SECTOR    -- GIME MAPPING REQUIRED
,'' AS SUBSECTOR  -- GIME MAPPING REQUIRED        
,'' AS CUSTCREATIONMODE
,'' AS FIRST_PRODUCT_PROCESSOR
,'' AS INTERFACE_REFERENCE_ID
,'' AS CUST_HEALTH_REF_CODE  
,'' AS TDS_CIFID
,'' AS PREF_CODE_RCODE
,'' AS CUST_SWIFT_CODE_DESC
,'' AS IS_SWIFT_CODE_OF_BANK
,'' AS NATIVELANGCODE_CODE
,'' AS CREATEDBYSYSTEMID
,'COMMEML' AS PREFERREDEMAILTYPE  
,'PHONE' AS PREFERREDPHONE      
,'' AS FIRST_NAME_NATIVE
,''  AS MIDDLE_NAME_NATIVE
,REPLACE(REPLACE(GRAND_FATHER_NAME,'|',''),'"','') AS LAST_NAME_NATIVE
,'' AS SHORT_NAME_NATIVE
,REPLACE(REPLACE(FATHER_NAME,'|',''),'"','')  AS FIRST_NAME_NATIVE1
,REPLACE(REPLACE(MOTHER_NAME,'|',''),'"','') AS MIDDLE_NAME_NATIVE1 --Grandmother name
,'NA' AS LAST_NAME_NATIVE1
,'' AS SHORT_NAME_NATIVE1
,'' AS SECONDARYRM_ID
,'' AS TERTIARYRM_ID
,'Sub Class A' AS SUBSEGMENT  -- GIME MAPPING REQUIRED
,'' AS ACCESSOWNERGROUP
,'' AS ACCESSOWNERSEGMENT
,'' AS ACCESSOWNERBC
,'' AS ACCESSOWNERAGENT
,'' AS ACCESSASSIGNEEAGENT
,'' AS CHARGELEVELCODE
,'' AS INTUSERFIELD1
,'' AS INTUSERFIELD2
,'' AS INTUSERFIELD3
,'' AS INTUSERFIELD4
,'' AS INTUSERFIELD5
,'' AS STRUSERFIELD1
,'' AS STRUSERFIELD2
,'N' AS STRUSERFIELD3 
,'' AS STRUSERFIELD4
,'' AS STRUSERFIELD5
,'' AS STRUSERFIELD6
,'' AS STRUSERFIELD7
,'' AS STRUSERFIELD8
,'' AS STRUSERFIELD9
,'' AS STRUSERFIELD10
,'' AS STRUSERFIELD11
,'' AS STRUSERFIELD12
,'' AS STRUSERFIELD13
,'' AS STRUSERFIELD14
,'' AS STRUSERFIELD15
,'' AS STRUSERFIELD16
,'' AS STRUSERFIELD17
,'' AS STRUSERFIELD18
,'' AS STRUSERFIELD19
,'' AS STRUSERFIELD20
,'' AS STRUSERFIELD21
,'' AS STRUSERFIELD22
,'' AS STRUSERFIELD23
,'' AS STRUSERFIELD24
,'N' AS STRUSERFIELD25  
,'' AS STRUSERFIELD26
,'' AS STRUSERFIELD27
,'' AS STRUSERFIELD28
,'' AS STRUSERFIELD29
,'' AS STRUSERFIELD30
,'' AS DATEUSERFIELD1
,'' AS DATEUSERFIELD2
,'' AS DATEUSERFIELD3
,'' AS DATEUSERFIELD4
,'' AS DATEUSERFIELD5
,'' AS BACKENDID
,'' AS RISK_PROFILE_SCORE
,'' AS RISK_PROFILE_EXPIRY_DATE
,'CELLPH' AS PREFERREDPHONETYPE  
,'EMAIL' AS PREFERREDEMAIL   
,'' AS NOOFCREDITCARDS
,'' AS REASONFORMOVINGOUT
,'' AS COMPETITORPRODUCTID
,'' AS OCCUPATIONTYPE
,'01' AS BANK_ID
,'' AS ZAKAT_DEDUCTION
,'' AS ASSET_CLASSIFICATION
,'' AS CUSTOMER_LEVEL_PROVISIONING
,'' AS ISLAMIC_BANKING_CUSTOMER  
,'' AS PREFERREDCALENDAR  
,'' AS IDTYPER1
,'' AS IDTYPER2
,'' AS IDTYPER3
,'' AS IDTYPER4
,'' AS IDTYPER5
,'' AS CUST_LAST_NAME_ALT1
,'' AS CUST_FIRST_NAME_ALT1
,'' AS CUST_MIDDLE_NAME_ALT1
,'' AS STRFIELD6_ALT1
,'' AS NAME_ALT1
,'' AS SHORT_NAME_ALT1
,'N' AS ISEBANKINGENABLED   
,'N' AS PURGEFLAG
,'N' AS SUSPENDED 
,'N' AS BLACKLISTED  
,'' AS NEGATED
,'' AS ACCOUNTID
,NVL(TRIM(REPLACE(replace(ADDRESS_LINE1,'|',''),'"','')),'NA') AS ADDRESS_LINE1
,''  AS ADDRESS_LINE2
,'' AS ADDRESS_LINE3
,'' AS STATE
,'' AS COUNTRY
,'44600' AS ZIP
,'' as BOCREATEDBYLOGINID
,'N' AS SUBMITFORKYC 
,'' AS KYC_REVIEWDATE
,'' AS KYC_DATE 
,'' AS RISKRATING --asked
,'N' AS SENIORCITIZEN --case when ((select db_stat_Date from gct )-NVL(CBS.date_of_birth,C.date_of_birth))/365 >=55 then 'Y' else 'N' end AS SENIORCITIZEN   
, '2-FEB-2050' AS SENCITIZENAPPLICABLEDATE 
,'' AS SENCITIZENCONVERSIONFLAG 
,'' AS FOREIGNACCTAXREPORTINGREQ
,'' AS FOREIGNTAXREPORTINGCOUNTRY
,'' AS FOREIGNTAXREPORTINGSTATUS
,'' AS LASTFOREIGNTAXREVIEWDATE
,'' AS NEXTFOREIGNTAXREVIEWDATE
,'' AS FATCAREMARKS
,'' AS DATEOFDEATH
,'' AS DATEOFNOTIFICATION
,'' AS PHYSICAL_STATE
,'' AS UNIQUEIDNUMBER
,'N' AS ENABLE_ALERTS
,'' AS DEFAULTCHANNEL_ALERT
,'' AS PREFERRED_MOBILE_ALERT_NO
,'' AS PREFERRED_MOBILE_ALERT_TYPE
FROM migration.customer_details C
join migration.CIF_ID cf on c.customer_id=cf.customer_id
where cif_id='R000028853'
--28082
